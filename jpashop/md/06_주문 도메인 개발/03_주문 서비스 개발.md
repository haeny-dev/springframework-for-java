### 주문 서비스 개발

*Cascade 의 범위*
- 다른 객체가 참조하지 않는 프라이빗하게 참조하는 대상에 대해서만 하는 것이 좋다.
- 다른 곳에서 참조하는 경우에 cascade 할 경우 다른 곳에서 참조여부에 대해 고려없이 삭제될 수 있기 떄문에 별도의 리포지토리를 생성해서 처리하는 것이 좋다.

*생성 메서드*
- 주문 및 주문상품의 생성 시에 엔티티에 만들어 놓은 생성 메서드를 사용한다.
- 하지만, 생성 매서드를 사용하지 않고 `new Order()` 와 같이 인스턴스를 생성하여 개발하는 것을 막아야한다.
- 그러기 위해서는 JPA 에서는 생성자에 접근범위를 protected 까지 설정할 수 있다.
- 이렇게 제약을 두는 개발을 해야 추후 유지보수 등을 용이하게 할 수 있다.

*변경사항*
- 주문취소 시에 주문상태가 취소로 변경된다던지, 주문 상품들의 재고가 다시 원복되는 변경이 발생한다.
- 이때 만약 쿼리를 직접 다루는 시스템의 경우 각 변경 사항에 대해서 쿼리를 작성하여 서비스단에서 반영하여야 한다.
- 하지만, JPA의 경우 더티체킹(?)을 통해서 변경사항에 대해서 확인하고 업데이트 쿼리를 작성해 처리해준다.

*비즈니스 로직*
- 주문과 주문 취소는 비즈니스 로직 대부분이 엔티티에 있다.
- 서비스 계층은 단순히 엔티티에 필요한 요청을 위임하는 역할을 한다.
- 이처럼 엔티티가 비즈니스 로직을 가지고 객체 지향의 특성을 적극 활용하는 것을 **도메인 모델 패턴** 이라 한다.
- 반대로 엔티티에는 비즈니스 로직이 거의 없고 서비스 계층에서 대부분의 비즈니스 로직을 처리하는 것을 **트랜잭션 스크립트 패턴** 이라 한다.

*참고*
- [도메인 모델 패턴](http://martinfowler.com/eaaCatalog/domainModel.html)
- [트랜잭션 스크립트 패턴](http://martinfowler.com/eaaCatalog/transactionScript.html)